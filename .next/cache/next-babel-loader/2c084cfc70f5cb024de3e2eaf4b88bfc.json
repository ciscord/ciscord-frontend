{"ast":null,"code":"import React from \"react\";\nvar __jsx = React.createElement;\nimport { useRef, useState, useCallback } from 'react';\nimport { useWindowDimensions } from 'hooks';\nimport { PortalWithState } from 'react-portal';\nimport { useMutation } from '@apollo/client';\nimport { TOGGLE_REACTION } from 'apis/Message';\nimport EmojiPicker from 'components/UI/EmojiPicker/EmojiPicker';\nimport Tooltip from 'components/UI/Tooltip';\nimport emojiIcon from 'public/icons/smile.svg';\nimport { Action, TooltipWrapper } from '../MessageActions.styled';\nimport * as S from './ReactionAction.styled';\nconst emojiPositionThreshold = 500;\nexport default (({\n  checkPosition,\n  messageId,\n  setShow\n}) => {\n  const ref = useRef(null);\n  const windowSize = useWindowDimensions();\n  const [toggleReaction] = useMutation(TOGGLE_REACTION);\n  const onEmojiClick = emoji => {\n    toggleReaction({\n      variables: {\n        name: emoji.colons,\n        messageId\n      }\n    });\n  };\n  const getPosition = useCallback(() => {\n    const {\n      y,\n      x\n    } = ref.current.getBoundingClientRect();\n    if (windowSize.height < y + 350) {\n      return {\n        x: windowSize.width - x,\n        y: windowSize.height - y + 10,\n        position: 't'\n      };\n    }\n    return {\n      x: windowSize.width - x,\n      y: y + 35,\n      position: 'b'\n    };\n  }, []);\n  return __jsx(PortalWithState, {\n    closeOnOutsideClick: true,\n    closeOnEsc: true,\n    node: document && document.getElementById('ReactModalPortal')\n  }, ({\n    openPortal,\n    closePortal,\n    portal\n  }) => __jsx(React.Fragment, null, __jsx(Action, {\n    \"aria-label\": \"Emoji\",\n    type: \"button\",\n    name: \"button\",\n    onClick: openPortal,\n    style: {\n      padding: 0\n    }\n  }, __jsx(S.ReactionIcon, {\n    ref: ref\n  }, __jsx(\"use\", {\n    xlinkHref: `${emojiIcon}#icon-smile`\n  })), __jsx(TooltipWrapper, null, __jsx(Tooltip, null, \"React\"))), portal(__jsx(EmojiPicker, {\n    getPosition: getPosition,\n    close: () => {\n      closePortal();\n      setShow(false);\n    },\n    onSelect: onEmojiClick\n  }))));\n});","map":{"version":3,"names":["useRef","useState","useCallback","useWindowDimensions","PortalWithState","useMutation","TOGGLE_REACTION","EmojiPicker","Tooltip","emojiIcon","Action","TooltipWrapper","S","emojiPositionThreshold","checkPosition","messageId","setShow","ref","windowSize","toggleReaction","onEmojiClick","emoji","variables","name","colons","getPosition","y","x","current","getBoundingClientRect","height","width","position","document","getElementById","openPortal","closePortal","portal","padding"],"sources":["/Volumes/MacData/work/ciscord-frontend.git/components/Chat/Message/Actions/Reaction/ReactionAction.js"],"sourcesContent":["import { useRef, useState, useCallback } from 'react';\nimport { useWindowDimensions } from 'hooks';\nimport { PortalWithState } from 'react-portal';\nimport { useMutation } from '@apollo/client';\nimport { TOGGLE_REACTION } from 'apis/Message';\n\nimport EmojiPicker from 'components/UI/EmojiPicker/EmojiPicker';\nimport Tooltip from 'components/UI/Tooltip';\n\nimport emojiIcon from 'public/icons/smile.svg';\nimport { Action, TooltipWrapper } from '../MessageActions.styled';\nimport * as S from './ReactionAction.styled';\n\nconst emojiPositionThreshold = 500;\n\nexport default ({ checkPosition, messageId, setShow }) => {\n  const ref = useRef(null);\n  const windowSize = useWindowDimensions();\n\n  const [toggleReaction] = useMutation(TOGGLE_REACTION);\n\n  const onEmojiClick = emoji => {\n    toggleReaction({\n      variables: {\n        name: emoji.colons,\n        messageId,\n      },\n    });\n  };\n\n  const getPosition = useCallback(() => {\n    const { y, x } = ref.current.getBoundingClientRect();\n\n    if (windowSize.height < y + 350) {\n      return { x: windowSize.width - x, y: windowSize.height - y + 10, position: 't' };\n    }\n    return { x: windowSize.width - x, y: y + 35, position: 'b' };\n  }, []);\n\n  return (\n    <PortalWithState\n      closeOnOutsideClick\n      closeOnEsc\n      node={document && document.getElementById('ReactModalPortal')}\n    >\n      {({ openPortal, closePortal, portal }) => (\n        <>\n          <Action\n            aria-label=\"Emoji\"\n            type=\"button\"\n            name=\"button\"\n            onClick={openPortal}\n            style={{ padding: 0 }}\n          >\n            <S.ReactionIcon ref={ref}>\n              <use xlinkHref={`${emojiIcon}#icon-smile`} />\n            </S.ReactionIcon>\n            <TooltipWrapper>\n              <Tooltip>React</Tooltip>\n            </TooltipWrapper>\n          </Action>\n          {portal(\n            <EmojiPicker\n              getPosition={getPosition}\n              close={() => {\n                closePortal();\n                setShow(false);\n              }}\n              onSelect={onEmojiClick}\n            />\n          )}\n        </>\n      )}\n    </PortalWithState>\n  );\n};\n"],"mappings":";;AAAA,SAASA,MAAM,EAAEC,QAAQ,EAAEC,WAAW,QAAQ,OAAO;AACrD,SAASC,mBAAmB,QAAQ,OAAO;AAC3C,SAASC,eAAe,QAAQ,cAAc;AAC9C,SAASC,WAAW,QAAQ,gBAAgB;AAC5C,SAASC,eAAe,QAAQ,cAAc;AAE9C,OAAOC,WAAW,MAAM,uCAAuC;AAC/D,OAAOC,OAAO,MAAM,uBAAuB;AAE3C,OAAOC,SAAS,MAAM,wBAAwB;AAC9C,SAASC,MAAM,EAAEC,cAAc,QAAQ,0BAA0B;AACjE,OAAO,KAAKC,CAAC,MAAM,yBAAyB;AAE5C,MAAMC,sBAAsB,GAAG,GAAG;AAElC,gBAAe,CAAC;EAAEC,aAAa;EAAEC,SAAS;EAAEC;AAAQ,CAAC,KAAK;EACxD,MAAMC,GAAG,GAAGjB,MAAM,CAAC,IAAI,CAAC;EACxB,MAAMkB,UAAU,GAAGf,mBAAmB,EAAE;EAExC,MAAM,CAACgB,cAAc,CAAC,GAAGd,WAAW,CAACC,eAAe,CAAC;EAErD,MAAMc,YAAY,GAAGC,KAAK,IAAI;IAC5BF,cAAc,CAAC;MACbG,SAAS,EAAE;QACTC,IAAI,EAAEF,KAAK,CAACG,MAAM;QAClBT;MACF;IACF,CAAC,CAAC;EACJ,CAAC;EAED,MAAMU,WAAW,GAAGvB,WAAW,CAAC,MAAM;IACpC,MAAM;MAAEwB,CAAC;MAAEC;IAAE,CAAC,GAAGV,GAAG,CAACW,OAAO,CAACC,qBAAqB,EAAE;IAEpD,IAAIX,UAAU,CAACY,MAAM,GAAGJ,CAAC,GAAG,GAAG,EAAE;MAC/B,OAAO;QAAEC,CAAC,EAAET,UAAU,CAACa,KAAK,GAAGJ,CAAC;QAAED,CAAC,EAAER,UAAU,CAACY,MAAM,GAAGJ,CAAC,GAAG,EAAE;QAAEM,QAAQ,EAAE;MAAI,CAAC;IAClF;IACA,OAAO;MAAEL,CAAC,EAAET,UAAU,CAACa,KAAK,GAAGJ,CAAC;MAAED,CAAC,EAAEA,CAAC,GAAG,EAAE;MAAEM,QAAQ,EAAE;IAAI,CAAC;EAC9D,CAAC,EAAE,EAAE,CAAC;EAEN,OACE,MAAC,eAAe;IACd,mBAAmB;IACnB,UAAU;IACV,IAAI,EAAEC,QAAQ,IAAIA,QAAQ,CAACC,cAAc,CAAC,kBAAkB;EAAE,GAE7D,CAAC;IAAEC,UAAU;IAAEC,WAAW;IAAEC;EAAO,CAAC,KACnC,4BACE,MAAC,MAAM;IACL,cAAW,OAAO;IAClB,IAAI,EAAC,QAAQ;IACb,IAAI,EAAC,QAAQ;IACb,OAAO,EAAEF,UAAW;IACpB,KAAK,EAAE;MAAEG,OAAO,EAAE;IAAE;EAAE,GAEtB,MAAC,CAAC,CAAC,YAAY;IAAC,GAAG,EAAErB;EAAI,GACvB;IAAK,SAAS,EAAG,GAAER,SAAU;EAAa,EAAG,CAC9B,EACjB,MAAC,cAAc,QACb,MAAC,OAAO,gBAAgB,CACT,CACV,EACR4B,MAAM,CACL,MAAC,WAAW;IACV,WAAW,EAAEZ,WAAY;IACzB,KAAK,EAAE,MAAM;MACXW,WAAW,EAAE;MACbpB,OAAO,CAAC,KAAK,CAAC;IAChB,CAAE;IACF,QAAQ,EAAEI;EAAa,EACvB,CACH,CAEJ,CACe;AAEtB,CAAC"},"metadata":{},"sourceType":"module"}