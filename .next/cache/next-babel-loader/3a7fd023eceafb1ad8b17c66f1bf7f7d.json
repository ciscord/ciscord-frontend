{"ast":null,"code":"import _objectWithoutProperties from \"@babel/runtime-corejs2/helpers/esm/objectWithoutProperties\";\nvar _excluded = [\"isChild\"];\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useRef, useState } from 'react';\nimport moment from 'moment';\nimport { PortalWithState } from 'react-portal';\nimport { useWindowDimensions } from 'hooks';\nimport UserPopup from 'components/UI/UserPopup';\nimport * as S from './styled';\n/* eslint-disable jsx-a11y/anchor-is-valid */\n\nvar ChildMessageWrapper = function ChildMessageWrapper(_ref) {\n  var message = _ref.message,\n    children = _ref.children,\n    isEditing = _ref.isEditing,\n    isDeleted = _ref.isDeleted;\n  return __jsx(S.Container, {\n    child: true,\n    isEditing: isEditing,\n    isDeleted: isDeleted\n  }, __jsx(S.Content, {\n    child: true\n  }, __jsx(S.Time, {\n    child: true\n  }, moment(message.createdAt).fromNow()), children));\n};\nvar UserPopupWrapper = function UserPopupWrapper(_ref2) {\n  var message = _ref2.message;\n  var ref = useRef(null);\n  var windowSize = useWindowDimensions();\n  var getPosition = function getPosition() {\n    var _ref$current$getBound = ref.current.getBoundingClientRect(),\n      y = _ref$current$getBound.y,\n      x = _ref$current$getBound.x;\n    if (windowSize.height < y + 350) {\n      return {\n        x: x,\n        y: windowSize.height - y + 10,\n        position: 't'\n      };\n    }\n    return {\n      x: x,\n      y: y + 35,\n      position: 'b'\n    };\n  };\n  return __jsx(PortalWithState, {\n    closeOnOutsideClick: true,\n    closeOnEsc: true,\n    node: document && document.getElementById('ReactModalPortal')\n  }, function (_ref3) {\n    var openPortal = _ref3.openPortal,\n      closePortal = _ref3.closePortal,\n      portal = _ref3.portal;\n    return __jsx(React.Fragment, null, __jsx(S.NameLink, {\n      ref: ref,\n      onClick: openPortal\n    }, message.author.username), portal(__jsx(UserPopup, {\n      username: message.author.username,\n      getPosition: getPosition,\n      close: function close() {\n        closePortal();\n      }\n    })));\n  });\n};\nvar ParentMessageWrapper = function ParentMessageWrapper(_ref4) {\n  var message = _ref4.message,\n    children = _ref4.children,\n    isEditing = _ref4.isEditing,\n    isPreview = _ref4.isPreview,\n    isDeleted = _ref4.isDeleted;\n  var _useState = useState(false),\n    showUserPopup = _useState[0],\n    setShowUserPopup = _useState[1];\n  return __jsx(S.Container, {\n    isEditing: isEditing,\n    onMouseLeave: function onMouseLeave() {\n      return setShowUserPopup(false);\n    },\n    isDeleted: isDeleted\n  }, __jsx(S.Avatar, {\n    name: message.author.username,\n    color: message.author.role.color,\n    src: message.author.image\n  }), __jsx(S.Content, null, __jsx(S.User, null, isPreview ? __jsx(S.Name, null, message.author.username) : __jsx(UserPopupWrapper, {\n    message: message\n  }), __jsx(S.Time, null, moment(message.createdAt).format('h:mm A'))), children));\n};\nvar MessageWrapper = function MessageWrapper(_ref5) {\n  var isChild = _ref5.isChild,\n    props = _objectWithoutProperties(_ref5, _excluded);\n  return isChild ? ChildMessageWrapper(props) : ParentMessageWrapper(props);\n};\nexport default MessageWrapper;","map":{"version":3,"names":["useRef","useState","moment","PortalWithState","useWindowDimensions","UserPopup","S","ChildMessageWrapper","message","children","isEditing","isDeleted","createdAt","fromNow","UserPopupWrapper","ref","windowSize","getPosition","current","getBoundingClientRect","y","x","height","position","document","getElementById","openPortal","closePortal","portal","author","username","ParentMessageWrapper","isPreview","showUserPopup","setShowUserPopup","role","color","image","format","MessageWrapper","isChild","props"],"sources":["/Volumes/MacData/work/ciscord-frontend.git/components/Chat/Message/_MessageWrapper/index.js"],"sourcesContent":["import { useRef, useState } from 'react';\nimport moment from 'moment';\nimport { PortalWithState } from 'react-portal';\nimport { useWindowDimensions } from 'hooks';\nimport UserPopup from 'components/UI/UserPopup';\nimport * as S from './styled';\n/* eslint-disable jsx-a11y/anchor-is-valid */\n\nconst ChildMessageWrapper = ({ message, children, isEditing, isDeleted }) => (\n  <S.Container child isEditing={isEditing} isDeleted={isDeleted}>\n    <S.Content child>\n      <S.Time child>{moment(message.createdAt).fromNow()}</S.Time>\n      {children}\n    </S.Content>\n  </S.Container>\n);\n\nconst UserPopupWrapper = ({ message }) => {\n  const ref = useRef(null);\n  const windowSize = useWindowDimensions();\n\n  const getPosition = () => {\n    const { y, x } = ref.current.getBoundingClientRect();\n\n    if (windowSize.height < y + 350) {\n      return { x, y: windowSize.height - y + 10, position: 't' };\n    }\n    return { x, y: y + 35, position: 'b' };\n  };\n\n  return (\n    <PortalWithState\n      closeOnOutsideClick\n      closeOnEsc\n      node={document && document.getElementById('ReactModalPortal')}\n    >\n      {({ openPortal, closePortal, portal }) => (\n        <>\n          <S.NameLink ref={ref} onClick={openPortal}>\n            {message.author.username}\n          </S.NameLink>\n          {portal(\n            <UserPopup\n              username={message.author.username}\n              getPosition={getPosition}\n              close={() => {\n                closePortal();\n              }}\n            />\n          )}\n        </>\n      )}\n    </PortalWithState>\n  );\n};\nconst ParentMessageWrapper = ({ message, children, isEditing, isPreview, isDeleted }) => {\n  const [showUserPopup, setShowUserPopup] = useState(false);\n\n  return (\n    <S.Container\n      isEditing={isEditing}\n      onMouseLeave={() => setShowUserPopup(false)}\n      isDeleted={isDeleted}\n    >\n      <S.Avatar name={message.author.username} color={message.author.role.color} src={message.author.image} />\n\n      <S.Content>\n        <S.User>\n          {isPreview ? (\n            <S.Name>{message.author.username}</S.Name>\n          ) : (\n            <UserPopupWrapper message={message} />\n          )}\n          <S.Time>{moment(message.createdAt).format('h:mm A')}</S.Time>\n        </S.User>\n        {children}\n      </S.Content>\n    </S.Container>\n  );\n};\nconst MessageWrapper = ({ isChild, ...props }) =>\n  isChild ? ChildMessageWrapper(props) : ParentMessageWrapper(props);\n\nexport default MessageWrapper;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}