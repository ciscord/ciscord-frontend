{"ast":null,"code":"import React from \"react\";\nvar __jsx = React.createElement;\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\nimport { useRef, useState } from 'react';\nimport moment from 'moment';\nimport { PortalWithState } from 'react-portal';\nimport { useWindowDimensions } from 'hooks';\nimport UserPopup from 'components/UI/UserPopup';\nimport * as S from './styled';\n/* eslint-disable jsx-a11y/anchor-is-valid */\n\nconst ChildMessageWrapper = ({\n  message,\n  children,\n  isEditing,\n  isDeleted\n}) => __jsx(S.Container, {\n  child: true,\n  isEditing: isEditing,\n  isDeleted: isDeleted\n}, __jsx(S.Content, {\n  child: true\n}, __jsx(S.Time, {\n  child: true\n}, moment(message.createdAt).fromNow()), children));\nconst UserPopupWrapper = ({\n  message\n}) => {\n  const ref = useRef(null);\n  const windowSize = useWindowDimensions();\n  const getPosition = () => {\n    const {\n      y,\n      x\n    } = ref.current.getBoundingClientRect();\n    if (windowSize.height < y + 350) {\n      return {\n        x,\n        y: windowSize.height - y + 10,\n        position: 't'\n      };\n    }\n    return {\n      x,\n      y: y + 35,\n      position: 'b'\n    };\n  };\n  return __jsx(PortalWithState, {\n    closeOnOutsideClick: true,\n    closeOnEsc: true,\n    node: document && document.getElementById('ReactModalPortal')\n  }, ({\n    openPortal,\n    closePortal,\n    portal\n  }) => __jsx(React.Fragment, null, __jsx(S.NameLink, {\n    ref: ref,\n    onClick: openPortal\n  }, message.author.username), portal(__jsx(UserPopup, {\n    username: message.author.username,\n    getPosition: getPosition,\n    close: () => {\n      closePortal();\n    }\n  }))));\n};\nconst ParentMessageWrapper = ({\n  message,\n  children,\n  isEditing,\n  isPreview,\n  isDeleted\n}) => {\n  const {\n    0: showUserPopup,\n    1: setShowUserPopup\n  } = useState(false);\n  return __jsx(S.Container, {\n    isEditing: isEditing,\n    onMouseLeave: () => setShowUserPopup(false),\n    isDeleted: isDeleted\n  }, __jsx(S.Avatar, {\n    name: message.author.username,\n    color: message.author.role.color,\n    src: message.author.image\n  }), __jsx(S.Content, null, __jsx(S.User, null, isPreview ? __jsx(S.Name, null, message.author.username) : __jsx(UserPopupWrapper, {\n    message: message\n  }), __jsx(S.Time, null, moment(message.createdAt).format('h:mm A'))), children));\n};\nconst MessageWrapper = _ref => {\n  let {\n      isChild\n    } = _ref,\n    props = _objectWithoutProperties(_ref, [\"isChild\"]);\n  return isChild ? ChildMessageWrapper(props) : ParentMessageWrapper(props);\n};\nexport default MessageWrapper;","map":{"version":3,"names":["useRef","useState","moment","PortalWithState","useWindowDimensions","UserPopup","S","ChildMessageWrapper","message","children","isEditing","isDeleted","createdAt","fromNow","UserPopupWrapper","ref","windowSize","getPosition","y","x","current","getBoundingClientRect","height","position","document","getElementById","openPortal","closePortal","portal","author","username","ParentMessageWrapper","isPreview","showUserPopup","setShowUserPopup","role","color","image","format","MessageWrapper","isChild","props"],"sources":["/Volumes/MacData/work/ciscord-frontend.git/components/Chat/Message/_MessageWrapper/index.js"],"sourcesContent":["import { useRef, useState } from 'react';\nimport moment from 'moment';\nimport { PortalWithState } from 'react-portal';\nimport { useWindowDimensions } from 'hooks';\nimport UserPopup from 'components/UI/UserPopup';\nimport * as S from './styled';\n/* eslint-disable jsx-a11y/anchor-is-valid */\n\nconst ChildMessageWrapper = ({ message, children, isEditing, isDeleted }) => (\n  <S.Container child isEditing={isEditing} isDeleted={isDeleted}>\n    <S.Content child>\n      <S.Time child>{moment(message.createdAt).fromNow()}</S.Time>\n      {children}\n    </S.Content>\n  </S.Container>\n);\n\nconst UserPopupWrapper = ({ message }) => {\n  const ref = useRef(null);\n  const windowSize = useWindowDimensions();\n\n  const getPosition = () => {\n    const { y, x } = ref.current.getBoundingClientRect();\n\n    if (windowSize.height < y + 350) {\n      return { x, y: windowSize.height - y + 10, position: 't' };\n    }\n    return { x, y: y + 35, position: 'b' };\n  };\n\n  return (\n    <PortalWithState\n      closeOnOutsideClick\n      closeOnEsc\n      node={document && document.getElementById('ReactModalPortal')}\n    >\n      {({ openPortal, closePortal, portal }) => (\n        <>\n          <S.NameLink ref={ref} onClick={openPortal}>\n            {message.author.username}\n          </S.NameLink>\n          {portal(\n            <UserPopup\n              username={message.author.username}\n              getPosition={getPosition}\n              close={() => {\n                closePortal();\n              }}\n            />\n          )}\n        </>\n      )}\n    </PortalWithState>\n  );\n};\nconst ParentMessageWrapper = ({ message, children, isEditing, isPreview, isDeleted }) => {\n  const [showUserPopup, setShowUserPopup] = useState(false);\n\n  return (\n    <S.Container\n      isEditing={isEditing}\n      onMouseLeave={() => setShowUserPopup(false)}\n      isDeleted={isDeleted}\n    >\n      <S.Avatar name={message.author.username} color={message.author.role.color} src={message.author.image} />\n\n      <S.Content>\n        <S.User>\n          {isPreview ? (\n            <S.Name>{message.author.username}</S.Name>\n          ) : (\n            <UserPopupWrapper message={message} />\n          )}\n          <S.Time>{moment(message.createdAt).format('h:mm A')}</S.Time>\n        </S.User>\n        {children}\n      </S.Content>\n    </S.Container>\n  );\n};\nconst MessageWrapper = ({ isChild, ...props }) =>\n  isChild ? ChildMessageWrapper(props) : ParentMessageWrapper(props);\n\nexport default MessageWrapper;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}