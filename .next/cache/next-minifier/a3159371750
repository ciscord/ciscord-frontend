{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{\"4mXO\":function(n,e,t){n.exports=t(\"7TPF\")},\"7TPF\":function(n,e,t){t(\"AUvm\"),n.exports=t(\"WEpk\").Object.getOwnPropertySymbols},\"9YjH\":function(n,e,t){(window.__NEXT_P=window.__NEXT_P||[]).push([\"/[company]/direct\",function(){return t(\"I0ri\")}])},I0ri:function(n,e,t){\"use strict\";t.r(e);var a=t(\"hfKm\"),r=t.n(a),i=t(\"2Eek\"),o=t.n(i),c=t(\"XoMD\"),s=t.n(c),u=t(\"Jo+v\"),l=t.n(u),d=t(\"4mXO\"),m=t.n(d),f=t(\"pLtp\"),h=t.n(f),p=t(\"dfwq\"),b=t(\"vYYK\"),g=t(\"q1tI\"),v=t.n(g),y=t(\"EcdV\"),x=t(\"nOHt\"),O=t(\"+TN3\"),j=t(\"5+Dc\"),w=t(\"00EI\"),N=t(\"nl1G\"),_=t(\"e9LY\"),$=t(\"B2fO\"),C=t(\"INPh\"),k=t(\"FVIk\"),U=t(\"vOnD\"),S=t(\"bame\"),I=U.default.div.withConfig({displayName:\"PrivateChatstyled__Wrapper\",componentId:\"sc-8rs5nu-0\"})([\"position:relative;margin-top:0 !important;padding:17px 20px;margin-bottom:0;display:flex;cursor:pointer;:hover{background:\",\";:after{background:\",\";}}.user-message-box__message{width:100%;margin-left:10px;}.user-message-box__info{display:flex;justify-content:space-between;}.user-message-box__text{width:100%;max-width:none;display:flex;justify-content:space-between;color:\",\";line-height:165%;}.user-message-box__name{color:\",\";font-size:15px;font-weight:700;letter-spacing:-0.15px;}.user-message-box__date{font-size:12px;font-weight:400;color:\",\";margin-left:1px;display:inline-block;}.message-count_blue{background-color:#69a9ff;color:#fff;margin-top:5px;}.message-count{width:23px;height:16px;border-radius:8px;display:flex;align-items:center;font-size:12px;font-weight:400;justify-content:center;}:after{content:'';height:1px;background-color:#e2e2e2;position:absolute;left:75px;right:0;display:block;bottom:0px;}\"],(function(n){return n.theme.communityBorderHover}),(function(n){return n.theme.communityBorderHover}),(function(n){return n.theme.chatAuthor}),(function(n){return n.theme.chatAuthor}),(function(n){return n.theme.chatAuthor})),A=Object(U.default)(S.a).attrs({alt:\"Avatar\"}).withConfig({displayName:\"PrivateChatstyled__Avatar\",componentId:\"sc-8rs5nu-1\"})([\"width:25px;height:25px;border-radius:5px;margin-right:10px;\",\"\"],(function(n){return n.width&&\"\\n    width: \".concat(n.width,\"px;\\n    height: \").concat(n.width,\"px;\\n    \")})),E=U.default.i.withConfig({displayName:\"PrivateChatstyled__Status\",componentId:\"sc-8rs5nu-2\"})([\"display:inline-block;width:6px;height:6px;border:2px solid #616061;border-radius:50%;margin-left:10px;box-sizing:content-box;\",\"\"],(function(n){return n.online&&\"\\n    width: 10px;\\n    height: 10px;\\n    background: #007a5a;\\n    border: none;\\n  \"})),P=v.a.createElement;function R(n,e){var t=h()(n);if(m.a){var a=m()(n);e&&(a=a.filter((function(e){return l()(n,e).enumerable}))),t.push.apply(t,a)}return t}function q(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?R(Object(t),!0).forEach((function(e){Object(b.a)(n,e,t[e])})):s.a?o()(n,s()(t)):R(Object(t)).forEach((function(e){r()(n,e,l()(t,e))}))}return n}var M=function(n){var e=n.username,t=n.channel,a=Object(g.useState)(!1),r=a[0],i=a[1],o=Object(x.useRouter)(),c=Object(g.useContext)(y.a).user,s=Object(O.b)(C.h,{variables:{username:e,channelUrl:t.url},fetchPolicy:\"cache-and-network\"}),u=s.data,l=(void 0===u?{}:u).getUnreadMessagesCount,d=s.loading,m=s.subscribeToMore;if(Object(g.useEffect)((function(){c&&l&&!r&&(m({document:$.j,variables:{tenant:Object(w.a)()},updateQuery:function(n,e){var t=e.subscriptionData;return t.data?q({},n,{user:t.data.user}):n}}),m({document:$.i,variables:{tenant:Object(w.a)()},updateQuery:function(n,e){var t=e.subscriptionData;return t.data?q({},n,{user:t.data.user}):n}}),m({document:_.e,variables:{receiverId:c.id,tenant:Object(w.a)()},updateQuery:function(n,e){var t=e.subscriptionData;if(!t.data)return n;var a=t.data.newNotification;return\"direct\"===a.type&&n.getUnreadMessagesCount.user.id===a.message.author.id?q({},n,{getUnreadMessagesCount:q({},n.getUnreadMessagesCount,{messages:[].concat(Object(p.a)(n.getUnreadMessagesCount.messages),[a.message])})}):n}}),i(!0))}),[l,c]),d||!l)return P(\"div\",null);return P(I,{key:t.id,onClick:function(){o.push(\"/[company]/[community]/[channel]\",\"/\".concat(Object(w.a)(),\"/\").concat(t.url))}},P(A,{name:l.user.username,width:36}),P(\"div\",{className:\"user-message-box__message\"},P(\"div\",{className:\"user-message-box__info\"},P(\"span\",{className:\"user-message-box__name\"},l.user.username,P(E,{online:l.user.isOnline})),P(\"span\",{className:\"user-message-box__date\"},l.messages.length>0&&Object(k.a)(l.messages[l.messages.length-1].createdAt))),P(\"div\",{className:\"user-message-box__text\"},P(\"div\",{className:\"text\"},P(\"p\",{className:\"fill\"},l.messages.length>0&&Object(k.c)(l.messages[l.messages.length-1].body,!1))),(l.messages.length>1||l.fromNewUser)&&P(\"div\",{className:\"message-count message-count_blue\"},l.fromNewUser?l.messages.length:l.messages.length-1))))},H=U.default.div.withConfig({displayName:\"styled__Wrapper\",componentId:\"va8wpq-0\"})([\"width:100%;height:calc(100% - 42px);border-left:1px solid \",\";outline:none;overflow-x:hidden;position:absolute;z-index:1;.chat-base-header{min-height:60px;align-items:center;display:flex;border-bottom:1px solid \",\";}.chat-base-header__title{color:\",\";font-size:15px;font-weight:700;margin-left:20px;}.chat-latest-body{margin-right:5px;width:100%;box-sizing:border-box;overflow-y:auto;}\"],(function(n){return n.theme.chatHeaderBorder}),(function(n){return n.theme.chatHeaderBorder}),(function(n){return n.theme.chatAuthor})),T=v.a.createElement;function X(n,e){var t=h()(n);if(m.a){var a=m()(n);e&&(a=a.filter((function(e){return l()(n,e).enumerable}))),t.push.apply(t,a)}return t}var z=function(){var n=Object(g.useState)(!1),e=n[0],t=n[1],a=Object(x.useRouter)();Object(j.a)(a.back);var i=Object(O.b)(N.e,{fetchPolicy:\"cache-and-network\"}),c=i.data,u=(void 0===c?{}:c).privateChannels,d=void 0===u?[]:u,m=i.loading,f=i.refetch,h=i.subscribeToMore,v=Object(g.useContext)(y.a).user;return Object(g.useEffect)((function(){v&&!e&&(t(!0),h({document:_.e,variables:{receiverId:v.id,tenant:Object(w.a)()},updateQuery:function(n,e){var t=e.subscriptionData;if(!t.data)return n;var a=t.data.newNotification;return\"direct\"===a.type&&0===n.privateChannels.filter((function(n){return n.id===a.channel.id})).length?function(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?X(Object(t),!0).forEach((function(e){Object(b.a)(n,e,t[e])})):s.a?o()(n,s()(t)):X(Object(t)).forEach((function(e){r()(n,e,l()(t,e))}))}return n}({},n,{privateChannels:[a.channel].concat(Object(p.a)(n.privateChannels))}):n}}))}),[v,h]),m||!v?T(\"div\",null):T(H,null,T(\"div\",{className:\"chat-base-header\",onClick:function(){return f()}},T(\"h3\",{className:\"chat-base-header__title\"},\"Private Chats\")),T(\"div\",{className:\"chat-latest-body\"},d&&d.map((function(n){var e=n.url.replace(\"direct/\",\"\").split(\"-\"),t=0===e.indexOf(v.username)?e[1]:e[0];return T(M,{key:n.id,username:t,channel:n})}))))};t.d(e,\"default\",(function(){return z}))},UXZV:function(n,e,t){n.exports=t(\"UbbE\")},UbbE:function(n,e,t){t(\"o8NH\"),n.exports=t(\"WEpk\").Object.assign},bame:function(n,e,t){\"use strict\";var a=t(\"kOwS\"),r=t(\"qNsG\"),i=t(\"q1tI\"),o=[\"name\",\"src\",\"style\"],c=t.n(i).a.createElement;e.a=function(n){var e=n.name,t=n.src,i=n.style,s=Object(r.a)(n,o);return c(\"img\",Object(a.a)({alt:\"Avatar\",src:t||\"https://ui-avatars.com/api/?name=\".concat(e),style:i},s))}},e9LY:function(n,e,t){\"use strict\";t.d(e,\"e\",(function(){return d})),t.d(e,\"b\",(function(){return m})),t.d(e,\"a\",(function(){return f})),t.d(e,\"c\",(function(){return h})),t.d(e,\"d\",(function(){return p}));var a,r,i,o,c,s=t(\"rt45\"),u=t(\"lTCR\"),l=t.n(u),d=l()(a||(a=Object(s.a)([\"\\n  subscription newNotification($receiverId: String!, $tenant: String!) {\\n    newNotification(receiverId: $receiverId, tenant: $tenant) {\\n      id\\n      type\\n      createdAt\\n      isRead\\n      message {\\n        id\\n        body\\n        createdAt\\n        author {\\n          id\\n          username\\n        }\\n      }\\n      receiver {\\n        id\\n        username\\n      }\\n      sender {\\n        id\\n        username\\n        isOnline\\n      }\\n      channel {\\n        url\\n        id\\n      }\\n      community {\\n        url\\n        id\\n      }\\n    }\\n  }\\n\"]))),m=l()(r||(r=Object(s.a)([\"\\n  query unreadNotifications {\\n    unreadNotifications {\\n      id\\n      type\\n      isRead\\n    }\\n  }\\n\"]))),f=l()(i||(i=Object(s.a)([\"\\n  query notifications {\\n    notifications {\\n      id\\n      type\\n      createdAt\\n      isRead\\n      message {\\n        id\\n        body\\n        createdAt\\n        author {\\n          id\\n          username\\n        }\\n      }\\n      receiver {\\n        id\\n        username\\n      }\\n      sender {\\n        id\\n        username\\n        isOnline\\n      }\\n      channel {\\n        url\\n        id\\n      }\\n      community {\\n        url\\n        id\\n      }\\n    }\\n  }\\n\"]))),h=l()(o||(o=Object(s.a)([\"\\n  mutation markNotificationsAsRead($type: String!) {\\n    markNotificationsAsRead(type: $type) {\\n      count\\n    }\\n  }\\n\"]))),p=l()(c||(c=Object(s.a)([\"\\n  mutation markNotificationAsRead($id: String!) {\\n    markNotificationAsRead(id: $id) {\\n      count\\n    }\\n  }\\n\"])))},kOwS:function(n,e,t){\"use strict\";t.d(e,\"a\",(function(){return i}));var a=t(\"UXZV\"),r=t.n(a);function i(){return(i=r.a||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(n[a]=t[a])}return n}).apply(this,arguments)}},nl1G:function(n,e,t){\"use strict\";t.d(e,\"d\",(function(){return h})),t.d(e,\"c\",(function(){return p})),t.d(e,\"a\",(function(){return b})),t.d(e,\"b\",(function(){return g})),t.d(e,\"f\",(function(){return v})),t.d(e,\"e\",(function(){return y}));var a,r,i,o,c,s,u,l,d=t(\"rt45\"),m=t(\"lTCR\"),f=t.n(m),h=(f()(a||(a=Object(d.a)([\"\\n  query channelNotifications($channelUrl: String!) {\\n    channelNotifications(channelUrl: $channelUrl) {\\n      id\\n    }\\n  }\\n\"]))),f()(r||(r=Object(d.a)([\"\\n  mutation markChannelNotificationsAsRead($channelUrl: String!) {\\n    markChannelNotificationsAsRead(channelUrl: $channelUrl) {\\n      id\\n    }\\n  }\\n\"]))),f()(i||(i=Object(d.a)([\"\\n  query channels($communityUrl: String!) {\\n    channels(communityUrl: $communityUrl) {\\n      id\\n      name\\n      url\\n      community {\\n        members {\\n          username\\n        }\\n      }\\n    }\\n  }\\n\"])))),p=f()(o||(o=Object(d.a)([\"\\n  query channel($url: String!) {\\n    channel(url: $url) {\\n      id\\n      name\\n      url\\n      description\\n      community {\\n        members {\\n          username\\n        }\\n      }\\n    }\\n  }\\n\"]))),b=f()(c||(c=Object(d.a)([\"\\n  mutation createChannel(\\n    $name: String!\\n    $description: String\\n    $url: String!\\n    $isPrivate: Boolean\\n    $communityUrl: String!\\n  ) {\\n    createChannel(\\n      name: $name\\n      description: $description\\n      url: $url\\n      isPrivate: $isPrivate\\n      communityUrl: $communityUrl\\n    ) {\\n      id\\n      name\\n      url\\n    }\\n  }\\n\"]))),g=f()(s||(s=Object(d.a)([\"\\n  mutation editChannel($channelId: String!, $name: String!, $description: String) {\\n    editChannel(channelId: $channelId, name: $name, description: $description) {\\n      id\\n      name\\n      description\\n      url\\n    }\\n  }\\n\"]))),v=f()(u||(u=Object(d.a)([\"\\n  subscription channelNewMessage($communityUrl: String, $tenant: String) {\\n    channelNewMessage(communityUrl: $communityUrl, tenant: $tenant) {\\n      id\\n      name\\n      url\\n    }\\n  }\\n\"]))),y=f()(l||(l=Object(d.a)([\"\\n  query privateChannels {\\n    privateChannels {\\n      id\\n      url\\n    }\\n  }\\n\"])))},o8NH:function(n,e,t){var a=t(\"Y7ZC\");a(a.S+a.F,\"Object\",{assign:t(\"kwZ1\")})},qNsG:function(n,e,t){\"use strict\";var a=t(\"4mXO\"),r=t.n(a),i=t(\"pLtp\"),o=t.n(i);function c(n,e){if(null==n)return{};var t,a,i=function(n,e){if(null==n)return{};var t,a,r={},i=o()(n);for(a=0;a<i.length;a++)t=i[a],e.indexOf(t)>=0||(r[t]=n[t]);return r}(n,e);if(r.a){var c=r()(n);for(a=0;a<c.length;a++)t=c[a],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(n,t)&&(i[t]=n[t])}return i}t.d(e,\"a\",(function(){return c}))}},[[\"9YjH\",2,1,0,3,4,5,6,9]]]);"}